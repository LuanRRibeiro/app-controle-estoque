<!-- templates/navbar.html -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
    <div class="container-fluid">
        <a class="navbar-brand pg-inicial-center" href="/painel">Painel Vendas</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDarkDropdown" aria-controls="navbarNavDarkDropdown" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavDarkDropdown">
            <ul class="navbar-nav me-auto d-flex align-items-center">
                <!-- Produtos -->
                <li class="nav-item dropdown">
                    <button class="btn btn-dark dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">Produtos</button>
                    <ul class="dropdown-menu dropdown-menu-dark">
                        <li><a class="dropdown-item" href="/cadastro_produtos">Cadastrar</a></li>
                        <li><a class="dropdown-item" href="/listar_produtos">Editar / Excluir</a></li>
                    </ul>
                </li>

                <!-- Filtros como dropdown -->
                <li class="nav-item dropdown ms-2">
                    <button class="btn btn-dark dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">Filtros</button>
                    <ul class="dropdown-menu dropdown-menu-dark">
                        <li><a class="dropdown-item" href="/filtro">Dashboard</a></li>
                        <li><a class="dropdown-item" href="#" onclick="carregarPrevisao()">Previsão de Vendas</a></li>
                    </ul>
                </li>
            </ul>

            <a class="navbar-brand" href="/logout">Sair</a>
        </div>
    </div>
</nav>

<!-- Script para o loading -->
<script>
function carregarPrevisao() {
    // Cria overlay
    let overlay = document.createElement("div");
    overlay.id = "loading-overlay";
    overlay.style.position = "fixed";
    overlay.style.top = "0";
    overlay.style.left = "0";
    overlay.style.width = "100%";
    overlay.style.height = "100%";
    overlay.style.backgroundColor = "rgba(0,0,0,0.5)";
    overlay.style.display = "flex";
    overlay.style.justifyContent = "center";
    overlay.style.alignItems = "center";
    overlay.style.zIndex = "9999";

    // Caixa centralizada com spinner
    overlay.innerHTML = `
        <div style="
            background: #fff;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0px 0px 20px rgba(0,0,0,0.4);
        ">
            <div class="spinner-border text-primary" style="width: 4rem; height: 4rem;" role="status"></div>
            <p class="mt-3 fs-5 text-dark">Aguarde, estamos analisando as previsões...</p>
        </div>
    `;
    document.body.appendChild(overlay);

    // Redireciona após pequeno delay para mostrar spinner
    setTimeout(() => {
        window.location.href = "/previsao_vendas";
    }, 400);
}
</script>
